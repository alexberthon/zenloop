<% content_for :head do %>
  <meta name="turbo-visit-control" content="reload">
<% end %>
<div class="map-side-bar">
  <div
    data-controller="journey"
    data-journey-selected-stations-value="<%= @selected_stations %>"
    data-journey-reachable-stations-value="<%= @reachable_stations %>"
    data-journey-existing-lines-value="<%= @existing_lines %>"
    data-journey-trip-lines-value="<%= @trip_lines %>"
    data-journey-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
    data-journey-journey-value="<%= @journey.to_json %>"
    >
    <div id="journey-map"></div>

    <div class="left-side text-center pt-4">
      <h4 class="fw-bold">Steps</h4>
      <%= simple_form_for @journey do |f| %>
        <div class="side-search search-form-control form-group d-none">
          <div id="dropdown-show">
            <%= f.select :station_start_id,
                Station.to_select,
                { include_blank: true },
                data: {
                  controller: 'tom-select',
                  placeholder: "Paris..."
                }%>
            <%= f.submit "Add step!", class: "btn btn-primary btn-sm", id:"small-button" %>
          </div>
        </div>
      <% end %>
      <%= render "shared/station_list", journey: @journey %>
      <div class="mx-auto mb-3">
        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" id="share" data-text="Hey! look at my journey on Zenloop!" data-hashtags="EcoTrip" data-lang="en" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
      </div>
    </div>
  </div>
<%= link_to "Save this journey!", journeys_path, class: "btn btn-primary", id:"cta" %>
</div>
